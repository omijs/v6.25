var n=Object.defineProperty,t=(t,e,s)=>(((t,e,s)=>{e in t?n(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s})(t,"symbol"!=typeof e?e+"":e,s),s);import{r as e,W as s,h as i,t as r,a}from"./vendor.d343fba9.js";var o=Object.defineProperty,l=Object.getOwnPropertyDescriptor;let h=class extends s{install(){this.store.ui.game=this}render(){return i("div",{class:"game"},this.store.data.map.map((n=>i("p",null,n.map((n=>i("b",n?{class:"s"}:null)))))))}};h.css=e('.game {\n\n  border: 2rpx solid #000;\n  padding: 10rpx 0 5rpx 0;\n  width: 725rpx;\n  margin: 10rpx auto;\n  background-color: #9ead86;\n  text-align: center;\n}\n\n.game p {\n  width: 725rpx;\n  height: 44rpx;\n  white-space: nowrap;\n  margin: 0;\n  padding: 0;\n}\n\n*{\n  box-sizing: border-box;\n}\n\n.game b {\n  display: inline-block;\n  width: 40rpx;\n  height: 40rpx;\n  padding: 4rpx;\n  border: 4rpx solid #879372;\n  margin: 0 4rpx 4rpx 0;\n}\n\n.game b.s:after {\n  background: #000;\n}\n\n.game b:after {\n  content: "";\n  display: block;\n  width: 24rpx;\n  height: 24rpx;\n  background: #879372;\n  overflow: hidden;\n}\n'),h=((n,t,e,s)=>{for(var i,r=s>1?void 0:s?l(t,e):t,a=n.length-1;a>=0;a--)(i=n[a])&&(r=(s?i(t,e,r):i(r))||r);return s&&r&&o(t,e,r),r})([r("my-game")],h);var p=Object.defineProperty,d=Object.getOwnPropertyDescriptor;let b=class extends s{install(){this.store.ui.index=this}render(){const{store:n}=this;return i("div",{class:"container"},i("h1",null,"OMI SNAKE"),i("my-game",null),i("div",{class:"ctrl"},i("div",{class:"btn cm-btn cm-btn-dir up",onClick:n.turnUp},i("i",null),i("em",null),i("span",null,"Up")),i("div",{class:"btn cm-btn cm-btn-dir down",onClick:n.turnDown},i("i",null),i("em",null),i("span",null,"Down")),i("div",{class:"btn cm-btn cm-btn-dir left",onClick:n.turnLeft},i("i",null),i("em",null),i("span",null,"Left")),i("div",{class:"btn cm-btn cm-btn-dir right",onClick:n.turnRight},i("i",null),i("em",null),i("span",null,"Right")),i("div",{class:"btn cm-btn space",onClick:n.toggleSpeed},i("i",null),i("span",null,"加速/减速")),i("div",{class:"btn reset small",onClick:n.reset},i("i",null),i("span",null,"Reset")),i("div",{class:"btn pp small",onClick:n.pauseOrPlay},i("i",null),i("span",null,n.data.paused?"Play":"Pause"))))}};b.css=e('.r {\n  float: right\n}\n\n.l {\n  float: left\n}\n\n.clear {\n  clear: both\n}\n\n* {\n  box-sizing: border-box;\n  margin: 0;\n  padding: 0;\n  -moz-user-select: none;\n  -webkit-user-select: none;\n  -ms-user-select: none;\n  user-select: none\n}\n\nh1{\n  text-align: center;\n}\n\n.ctrl {\n  width: 580rpx;\n  height: 330rpx;\n  margin: 20rpx auto 0;\n  position: relative\n}\n\n.btn {\n  text-align: center;\n  color: #111;\n  position: absolute;\n  white-space: nowrap;\n  line-height: 1.6\n}\n\n.btn.small {\n  font-size: 16rpx\n}\n\n\n\n.btn i {\n  display: block;\n  position: relative;\n  border: 1rpx solid #000;\n  border-radius: 50%;\n  box-shadow: 0 3rpx 3rpx rgba(0, 0, 0, .2)\n}\n\n.btn i:after,\n.btn i:before {\n  content: "";\n  display: block;\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  top: 0;\n  left: 0;\n  border-radius: 50%;\n  box-shadow: inset 0 5rpx 10rpx hsla(0, 0%, 100%, .8)\n}\n\n.btn i:after {\n  box-shadow: inset 0 -5rpx 10rpx rgba(0, 0, 0, .8)\n}\n\n.btn i._23aw:before {\n  box-shadow: inset 0 -3rpx 6rpx hsla(0, 0%, 100%, .6)\n}\n\n.btn i._23aw:after {\n  box-shadow: inset 0 5rpx 5rpx rgba(0, 0, 0, .6)\n}\n\n.btn.cm-btn i {\n  background: #5a65f1;\n  background: -moz-linear-gradient(top, #6e77ef, #6e77ef)\n}\n\n.btn.pp i {\n  background: #2dc421;\n  background: -moz-linear-gradient(top, #4bc441, #4bc441)\n}\n\n.btn.reset i {\n  background: #dd1a1a;\n  background: -moz-linear-gradient(top, #dc3333, #dc3333)\n}\n\n.btn.space i {\n  width: 160rpx;\n  height: 160rpx\n}\n\n\n.btn i:active {\n  transform: scale(0.9);\n}\n\n\n.btn.cm-btn-dir i {\n  width: 100rpx;\n  height: 100rpx\n}\n\n.btn.small i {\n  width: 52rpx;\n  height: 52rpx;\n  box-shadow: 1rpx 1rpx 1rpx rgba(0, 0, 0, .2)\n}\n\n.btn.small i:after,\n.btn.small i:before {\n  box-shadow: inset 0 3rpx 6rpx hsla(0, 0%, 100%, .8)\n}\n\n.btn.small i:after {\n  box-shadow: inset 0 -3rpx 6rpx rgba(0, 0, 0, .8)\n}\n\n.btn.small i._23aw:before {\n  box-shadow: inset 0 -1rpx 2rpx hsla(0, 0%, 100%, .6)\n}\n\n.btn.small i._23aw:after {\n  box-shadow: inset 0 3rpx 3rpx rgba(0, 0, 0, .7)\n}\n\n.btn.cm-btn-dir em {\n  display: block;\n  width: 0;\n  height: 0;\n  border: 8rpx solid;\n  border-color: transparent transparent #111;\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  margin: -18rpx 0 0 -8rpx\n}\n\n\n.up {\n  top: 0rpx; \n  left: 374rpx;\n}\n\n.up em{\n  transform: translate(0rpx, 70rpx) scale(1, 2);\n}\n\n\n.up span {\n  position: absolute;\n  top: 5rpx;\n  left: 102rpx\n}\n\n.down{\n  top: 180rpx; \n  left: 374rpx;\n}\n\n.down em{\n  transform: translate(0rpx, -71rpx) rotate(180deg) scale(1, 2);\n}\n\n.left{\n  top: 90rpx; \n  left: 284rpx;\n}\n\n.left em{\n  transform: translate(60rpx, -12rpx) rotate(270deg) scale(1, 2);\n}\n\n.right{\n  top: 90rpx; left: 464rpx;\n}\n\n.right em{\n  transform: translate(-60rpx, -12rpx) rotate(90deg) scale(1, 2);\n}\n\n.space{\n  top: 100rpx; \n  left: 52rpx;\n}\n\n.reset{\n  top: 0rpx; \n  left: 156rpx;\n}\n\n.pp{\n  top: 0rpx; \n  left: 60rpx;\n}\n'),b=((n,t,e,s)=>{for(var i,r=s>1?void 0:s?d(t,e):t,a=n.length-1;a>=0;a--)(i=n[a])&&(r=(s?i(t,e,r):i(r))||r);return s&&r&&p(t,e,r),r})([r("my-index")],b);class c{constructor(){this.body=[3,1,2,1,1,1],this.dir="right"}move(n){const t=this.body;switch(n||(t.pop(),t.pop()),this.dir){case"up":t.unshift(t[0],t[1]-1);break;case"right":t.unshift(t[0]+1,t[1]);break;case"down":t.unshift(t[0],t[1]+1);break;case"left":t.unshift(t[0]-1,t[1])}}turnUp(){"down"!==this.dir&&(this.dir="up")}turnRight(){"left"!==this.dir&&(this.dir="right")}turnDown(){"up"!==this.dir&&(this.dir="down")}turnLeft(){"right"!==this.dir&&(this.dir="left")}}class u{constructor(n){this.map=[],this.size=16,this.loop=null,this.interval=500,this.paused=!1,this._preDate=Date.now(),this.init(),this.onTick=n.onTick}init(){this.snake=new c;for(let n=0;n<this.size;n++){const n=[];for(let t=0;t<this.size;t++)n.push(0);this.map.push(n)}}tick(){this.makeFood();const n=this.eat();this.snake.move(n),this.mark(),this.onTick()}mark(){const n=this.map;for(let t=0;t<this.size;t++)for(let e=0;e<this.size;e++)n[t][e]=0;for(let t=0,e=this.snake.body.length;t<e;t+=2)this.snake.body[t+1]%=this.size,this.snake.body[t]%=this.size,this.snake.body[t+1]<0&&(this.snake.body[t+1]+=this.size),this.snake.body[t]<0&&(this.snake.body[t]+=this.size),n[this.snake.body[t+1]][this.snake.body[t]]=1;this.food&&(n[this.food[1]][this.food[0]]=1)}start(){this.loop=setInterval((()=>{Date.now()-this._preDate>this.interval&&(this._preDate=Date.now(),this.paused||this.tick())}),16)}stop(){clearInterval(this.loop)}pause(){this.paused=!0}play(){this.paused=!1}reset(){this.paused=!1,this.interval=500,this.snake.body=[3,1,2,1,1,1],this.food=null,this.snake.dir="right"}toggleSpeed(){500===this.interval?this.interval=150:this.interval=500}makeFood(){if(!this.food){this.food=[this._rd(0,this.size-1),this._rd(0,this.size-1)];for(let n=0,t=this.snake.body.length;n<t;n+=2)if(this.snake.body[n+1]===this.food[1]&&this.snake.body[n]===this.food[0]){this.food=null,this.makeFood();break}}}eat(){for(let n=0,t=this.snake.body.length;n<t;n+=2)if(this.snake.body[n+1]===this.food[1]&&this.snake.body[n]===this.food[0])return this.food=null,!0}_rd(n,t){return n+Math.floor(Math.random()*(t+1))}}var x=new class{constructor(){t(this,"turnUp",(()=>{this.snake.turnUp()})),t(this,"turnRight",(()=>{this.snake.turnRight()})),t(this,"turnDown",(()=>{this.snake.turnDown()})),t(this,"turnLeft",(()=>{this.snake.turnLeft()})),t(this,"pauseOrPlay",(()=>{this.game.paused?(this.game.play(),this.data.paused=!1):(this.game.pause(),this.data.paused=!0),this.ui.index.updateSelf()})),t(this,"reset",(()=>{this.game.reset()})),t(this,"toggleSpeed",(()=>{this.game.toggleSpeed()}));const n=new u({onTick:()=>{this.ui.game.update()}}),{snake:e,map:s}=n;this.snake=e,this.map=s,this.game=n,n.start(),this.ui={},this.data={map:s,paused:!1}}};x.ignoreAttrs=!0,a(i("my-index",null),"#root",x);
